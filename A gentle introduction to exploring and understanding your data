Ce cours a été créé pour l'École des Données par le collectif Tactical Technology. Tactical Tech est une ONG internationale travaillant là où la défense des droits rencontre l'information et la technologie. Ce cours repose sur le cours précédent de Tactical Tech pour l'École des Données, A Gentle Introduction to Cleaning Data.

Table des matières
Introduction
Section 1: Commencer
Section 2: Rendre un tableau croisé dynamique plus utile en ajoutant des «champs de données»
Section 3: Ajouter des colonnes aux tableaux croisés dynamiques
Section 4: Ajouter des graphiques aux tableaux croisés dynamiques

Introduction
2 + 2 = ___
Votre résistance à répondre à cette question est futile: vous y avez probablement répondu sans même y penser.

Nous doutons qu'il soit sujet à controverse de dire que beaucoup des personnes suivant ce cours ont l'instinct et le besoin de connaître la somme d'une colonne de nombres, ou comment les nombres sont répartis dans les différentes catégories dans le jeu de données que vous étudiez. Les feuilles de calcul simplifient ce genre d'analyse descriptive en vous donnant un kit de fonctions mathématiques pour additionner, soustraire, multiplier, diviser et créer des moyennes et des pourcentages à partir de nombres. Nous pensons que vous savez comment utiliser certaines de ces fonctions, mais si vous souhaitez remettre vos connaissances à niveau, parcourez le cours fondamental sur l'analyse de données.

Néanmoins, les feuilles de calcul ont un autre puissant outil d'analyse descriptive appelé les tableaux croisés dynamiques. Pour résumer, voici ce qu'ils font:

http://farm9.staticflickr.com/8114/8651881402_8622b4d4a1_o_d.png
Image: “Plus de chatons”, fourni par Hitchster. Certains droits réservés: CC-BY 2.0. Adapté par Tactical Tech.


Les tableaux croisés dynamiques résument des jeux de données complets sans vous demander d'écrire des formules, créer de nouvelles colonnes, ou arranger vos données d'une façon particulière. Ils vous permettent de combiner des données de façons qui révèlent les relations existant dans les données et vous les montrent sous un nouveau jour. Ils ne changent pas vos données, mais ont un tas de fonctions intégrées utiles dont l'utilisation efficace vous épargnera beaucoup de tâches répétitives et vous feront gagner du temps.

Une combinaison de fonctions de tableur − comme trier et filtrer et quelques formules − fonctionne comme les tableaux croisés dynamiques dans le sens où elles vous permettent de réarranger et sortir de petits morceaux de données plus facilement. Les tableaux croisés dynamiques font ces choses pour les jeux de données complets et vous les présentent pour que vous voyiez tout.

En suivant ce cours, vous aller:

- comprendre les bases des tableaux croisés dynamiques et leur fonctionnement;
- créer environt 20 exemples différents de tableaux croisés dynamiques;
- être capable de construire et adapter la disposition des tableaux croisés dynamiques;
- être capable d'utiliser les tableaux croisés dynamiques pour examiner et explorer un jeu de données.


Prérequis pour le cours
La gentille introduction à l'exploration et à la compréhension de vos données se base sur deux autres cours de l'école des données:

1. Fondamentaux sur les données, qui couvre les bases des données et comment travailler avec un tableur;
2. Une gentille introduction au nettoyage de données, qui observe les quatre façons les plus courantes pour les données de devenir désorganisées et sales, et aborde leur résolution pratique grâce à un tableur.
Pour suivre ce cours, vous aurez besoin des choses suivantes:

1. Une version à jour du logiciel libre et ouvert LibreOffice installé sur votre ordinateur. Nous supposons que vous savez comment faire cela. Nous avons choisi d'utiliser LibreOffice parce qu'il ne coûte rien (contrairement à Microsoft Excel), n'envahit pas systématiquement votre vie privée et ne nécessite pas une connexion permanente et rapide à internet (contrairement à Google Spreadsheet).
2. une copie de l'exemple de jeu de données pour ce cours, qui est un petit jeu de données concernant les étagères de la cuisine de l'auteur. Durant le cours, nous l'utiliserons pour montrer les bases des tableaux croisés dynamiques.
3. une copie des données GRAIN sur l'appropriation de terrain. Ce jeu de données est typique de ceux que les organisations non gouvernementales (ONG) peuvent créer et utiliser. Nous l'avons utilisé précédemment comme exemple dans notre cours sur le nettoyage des données. Deux feuilles de calcul composent le document: les données «sales» d'origine et la version «nettoyée». Nous travaillerons avec la version nettoyée.

Contenu du cours
Ce cours est composé de quatre sections.

- La section 1 couvre les premières étapes de la création d'un tableau croisé dynamique, montrant ce qu'il arrive à vos données lorsqu'elles sont ajoutées à un champ colonne dans un tableau croisé dynamique.
- Dans la section 2, nous regardons comment rendre un tableau croisé dynamique encore plus efficace en ajoutant des «champs de données».
- L'ajout de champs de colonne est abordé dans la section 3.
- Pour terminer le cours, la section 4 montre comment créer des graphiques à partir des données des tableaux croisés dynamiques pour ajouter un aspect visuel à votre compréhension des données.

Chaque section contient trois parties:

- Un exercice rapide qui utilise un jeu de données concernant une étagère de cuisine pour illustrer le concept des tableaux croisés dynamiques.
- Un exercice plus long utilisant un jeu de données sur la vente massive de terres agricoles dans les pays en développement. Cette partie va plus profondément dans la création de tableaux croisés dynamiques, avec d'autres problèmes qui vous aideront à mettre vos nouvelles compétences en pratique.
- Un bonus qui explique comment les tableaux croisés dynamiques peuvent être liés aux autres fonctionnalités utiles d'un tableur.

Comment suivre ce cours.
Ce cours est relativement court. Nous vous suggérons de travailler sur les sections 1 à 4 d'une traite, car les dernières sections n'auront pas beaucoup de sens traitées séparément.

Section 1: Commencer
Assurez-vous d'avoir une copie des exemples de jeux de données et ouvrez jeu de données GRAIN sur l'appropriation de terrain dans LibreOffice.

Une tâche rapide
Regardez l'exemple de jeu de données sur la sélection de snacks dans les étagères de la cuisine de l'auteur. Il y a des données sur leurs ingrédients principaux, la quantité et les risques qu'ils posent à la santé de l'auteur:

http://farm9.staticflickr.com/8528/8650783189_8c39e83f5a_o_d.png

Commencez par construire un tableau croisé dynamique à partir des données des feuilles de calcul:

1. Sélectionnez toutes les données. Vous pouvez le faire en sélectionnant la cellule A1 et en glissant la souris jusqu'à la cellule D9, ou en pressant Ctrl-A (Cmd-A sur les ordinateurs Apple).

2. Avec les données sélectionnées, choisissez Données → Tableau croisé dynamique → Créer à partir de la feuille de calcul dans me menu du haut. Une fenêtre apparaîtra pour demander si vous souhaitez utiliser la «sélection courante». Choisissez OK.

3. Comme illustré ci-dessous, vous verrez quelques zones grises dont les en-têtes correspondent à vos données brutes.

4. Pivotons-les, c'est-à-dire, changeons une colonne en ligne. Sélectionnez et maintenez la zone étiquettée Snack et glissez-la dans la zone blanche appelée Row Field, tel qu'illustré ci-dessous:

http://farm9.staticflickr.com/8259/8650783239_013f6acaf3_b_d.jpg

5. Cliquez sur OK. Une nouvelle feuille de calcul sera créée et que vous verrez dans les onglets en bas du tableur. Ci-dessous, les données qu'il contiendra:

http://farm9.staticflickr.com/8404/8651881512_d5de55d642_o_d.png

Alors, qu'est-il arrivé aux données?

Dans les données d'origines, «Biscuit» est mentionné trois fois: le tableau croisé dynamique ne le montre qu'une seule fois. «Sandwich» est mentionné deux fois: le tableau croisé dynamique ne le montre qu'une seule fois. Et ainsi de suite. Le tableau croisé dynamique a regroupé et résumé les données de la colonne Snack de vos données brutes. Il répond à la question du nombre de types de snacks différents présents dans les données.

Les tableaux croisés dynamiques peuvent être créés avec plus d'un champ ligne. À partir du jeu de données d'exemple, choisissons une autre ligne de données à ajouter:

1. Dans le tableau croisé que vous avez créé se trouve un menu secondaire. Il peut être activé avec un clic droit de votre souris (ou un coup à deux doigts sur le keypad des ordinateurs Apple) n'importe où sur le tableau. Cela ressemblera à ceci:

http://farm9.staticflickr.com/8254/8651881506_4358fa812e_o_d.png

2. Choisissez Modifier le layout. Cela ouvrira à nouveau l'éditeur de tableau croisé. Cette fois-ci, glisser Ingredient dans la zone de champs ligne puis cliquez sur OK. Les données produites par le tableau sont maintenant différentes:

http://farm9.staticflickr.com/8405/8651881524_aca9fa03a0_o_d.png

Que s'est-il produit? Comme précédemment, le tableau croisé dynamique a également groupé et résumé les données concernant les 'Ingredients'. Ce qu'il y a de bien est qu'il a groupé les données sur les ingrédients pour les montrer pour chaque type de snack. Nous pouvons retourner cela pour avoir une autre vue, de la perspective des ingrédients et non depuis celle des friandises.

Pour cela, modifiez à nouveau le layout de tableau croisé (clic droit sur le tableau), réordonnez les tuiles apparaissant en tant que champs de ligne (comme montré ci-dessous) pour placer 'Ingredients' en haut.

http://farm9.staticflickr.com/8546/8650783267_cda9dc955d_o_d.png

Choisissez OK pour recréer le tableau croisé avec la nouvelle organisation. Voici à quoi les données vont ressembler:

http://farm9.staticflickr.com/8249/8650783409_2779f16f42_o_d.png

Dans ce tableau croisé, les groupes de valeurs sont arrangés différemment. Plutôt que montrer les ingrédients présents dans chaque friandise, il montre les types de snack contenant un ingrédient particulier.

Vous avez compris? Essayons d'appliquer cela sur un jeu de données plus grand où nous pouvons voir les valeurs d'un tableau croisé de façon plus flagrante.

Une tâche plus longue
Essayons la même technique sur le plus grand jeu de données GRAIN sur l'appropriation commerciale de terrain, une version nettoyée que vous pouvez télécharger depuis le Datahub.

Prenez le temps de vous familiariser avec ce jeu de données. Un bonne (mais plus longue) façon de faire est de suivre le cours de l'école des données appelé A Gentle Introduction to Cleaning Data, qui utilise également ce jeu de données comme base.

Si vous n'en avez pas le temps, les bases de ce jeu de données sont les suivantes:

- le jeu de données a été produit par GRAIN, une organisation de recherche et de promotion (advocacy) qui travaille pour soutenir la biodiversité et les systèmes de nourriture durables et contrôlés par la communauté;
- chaque ligne du jeu de données contient des détails concernant la vente d'un très grand nombse de terres agricoles dans un pays, souvent dans un pays du sud;
- les colonnes contiennent des données concernant les noms des investisseurs et les pays où ils sont basés, le pays où la vente des terres a eu lieu, la taille des terres, la quantité d'argent investie pour acheter la parcelle et si la vente s'est faite.

Pour créer un tableau croisé du jeu de données GRAIN, les étapes sont les mêmes:

1. Sélectionnez le jeu de données complet (de la cellule A1 à la I417). N'oubliez pas que les données non sélectionnées ne seront pas incluses dans le tableau.
2. Dans le menu du haut, sélectionnez Données → Tableau croisé dynamique → Créer.
3. Dans le fenêtre qui apparaît, choisissez "Sélection courante" et cliquez sur "OK".
4. Choisissez le layout de votre tableau croisé en déplaçant les "tuiles" représentant les différentes colonnes de données dans différentes parties du layout du tableau.
5. Lorsque vous êtes satisfait, sélectionnez "OK" pour créer le tableau.
6. Si vous voulez changer l'organisation du tableau croisé, faites un clic droit sur le tableau pour afficher un menu secondaire et sélectionnez "Modifier l'organisation".
Le jeu de données GRAIN a neuf colonnes de données. Dans cette leçon, nous allons juste ajouter différentes combinaisons de champs dans les champs de lignes du tableau croisé pour répondre à des questions spécifiques.

Nous allons traverser une des questions pour vous faire commencer: "Dans quels pays des terres ont-elles été acquises?"

1. Les données qu'il vous faut pour répondre à cela sont dans la colonne A, appelée "Landgrabbed"

2. Sélectionnez tout le jeu de données. Allez dans Données → Tableau croisé dynamiques → Créer.

3. Choisissez "Sélection actuelle" et la fenêtre de structure vide va apparaître, telle que ci-dessous:

http://farm9.staticflickr.com/8264/8651881598_507370689f_b_d.jpg

4. Ah ah! Comme vous pouvez le voir, deux tuiles portent le même nom. Cela vient du fait que deux colonnes sont très similaires − "LandgrabbeD" et "LandgrabbeR" − et la structure du tableau croisé dynamique tronque les noms. Faites passer votre souris sur les tuiles pour révéler le nom complet de la colonne de données que vous souhaitez ajouter, comme ci-dessous:

http://farm9.staticflickr.com/8262/8650783349_4a70be6197_o_d.png

5. Maintenant que vous savez quelle tuile contient les bonnes données, glissez "Landgrabbed" dans la zone des champs de colonne et cliquez sur OK pour créer le tableau:

http://farm9.staticflickr.com/8528/8650783423_9e1dc2f9a0_b_d.jpg

6. Les données dans ce tableau croisé dynamique comme ci-dessous, une liste de pays:

http://farm9.staticflickr.com/8264/8651881642_5b064291ed_o_d.png

Nous pouvons maintenant travailler sur cette liste pour améliorer notre compréhension de ce qui se trouve dans le jeu de données. Par exemple, en modifiant la structure et en déplaçant la tuile appelée "Landgrabber" dans la zone des champs colonnes, nous pouvons répondre à cette question: "Quelles sociétés ont acquis des terres dans quels pays?"

1. Voici à quoi la structure du tableau devrait ressembler:

http://farm9.staticflickr.com/8252/8651881694_ab1b3b1853_b_d.jpg

2. Après avoir cliqué sur "OK", voici les quelques premières colonnes de données que vous aurez dans le tableau croisé dynamique:

http://farm9.staticflickr.com/8109/8651881792_32af36febd_o_d.png

3. Pour plus de points, essayez d'inverser l'ordre des tuiles et de créer un tableau à partir de cette organisation. Ce tableau vous montrera les mêmes données, mais arrangées autour de l'investisseur (le "Landgrabber") plutôt que du pays où un terrain a été acquis. Voici un morceau des données que vous obtiendrez de cette organisation:

http://farm9.staticflickr.com/8543/8650783527_d90b0bb1e6_o_d.png

Maintenant que vous êtes un expert, voici quelques autres questions auxquelles vous pouvez répondre en ajoutant des données dans le champ Colonne d'un tableau croisé dynamique. Essayez celles-ci:

1. Dans quels pays les investisseurs sont-ils basés (leur base)?
2. Dans quels pays les investisseurs sont-ils basés et où ont-ils acquis des terrains?
3. Quels investisseurs travaillent dans quels secteurs?
4. Quels investisseurs travaillent dans quels secteurs et comment ont-ils utilisé les terrains qu'ils ont acquis? Indice: les données sur l'utilisation d'un terrain sont dans la colonne appelée "Production".
5. Quelles sociétés travaillent dans quels secteurs, décomposé par pays où elles sont basées?
6. Quels sont les noms des investisseurs ayant fait des acquisitions de terrain de taille similaire et dans quels pays ont-ils fait ces acquisitions?
7. À quoi ont été utilisés les terrains de taille similaire, dans quel pays et quel était le statut de la transaction?

Fonctionnalité bonus: tri et filtre automatique
Là où vous voyez un triangle orienté vers le bas dans la ligne du haut d'un tableau croisé, cliquez pour activer les fonctionnalités de tri et de filtre automatique du tableur. Cliquez dessus pour faire apparaître l'interface et jouez avec pour voir comment cela affecte les données dans le tableau.

Section 2: Rendez un tableau croisé dynamique encore plus utile en ajoutant des "champs de données"
Dans la première section, nous avons créé des listes triées et groupées pouvant utiliser vos données pour répondre à des questions. Mais que peut un tableau croisé dynamique faire d'autre? Dans cette section, nous allons regarder comment la partie "Champ de données" d'un tableau croisé fonctionne.

Une tâche rapide
Construisez à nouveau un tableau croisé dynamique des différents types de snack, comme montré dans la section précédente. En revanche, nous allons cette fois ajouter un "Champ de donnée" qui va calculer combien il y a de chaque type de snack:

1. La structure de votre tableau devrait ressembler à l'image ci-dessous:

http://farm9.staticflickr.com/8522/8650783577_b64b706933_b_d.jpg

2. Après la création du tableau, les données que vous aurez ressembleront à ceci:

http://farm9.staticflickr.com/8263/8650783579_7b37cd0f45_o_d.png

Que s'est-il passé?

Le tableau croisé dynamique a groupé et résumé les données sur les types de snacks, que vous avez mis dans un champ données. Les données sur la quantité de snacks − que vous avez mise dans le champ de données − ont été ajoutées pour créer un total pour chaque type de snack. Pas mail, hein? Ajoutons un autre champ de données, comme nous l'avons fait dans la section 1, et voyons ce qu'il nous dit:

1. Faites apparaître le menu secondaire en cliquant droit sur le tableau et sélectionnez "modifier la structure".

2. Modifiez la structure du tableau pour qu'elle ressemble à ceci:

http://farm9.staticflickr.com/8263/8650783605_68b4b3af7c_b_d.jpg

3. Les données affichées vont encore changer. Cette fois, les types de snacks sont réunis en sous-groupes par type d'ingrédient avec les quantités:

http://farm9.staticflickr.com/8393/8650783633_8cd805bc48_o_d.png

Une tâche plus longue
Nous pouvons répéter les mêmes étapes sur le jeu de données GRAIN pour créer des vues représentant les données de façon plus utiles. Par exemple, cherchons la quantité de terrain acquise dans chaque pays:

1. Nous ne répétons pas toutes les étapes nécessaires à la création du tableau, mais nous vous montrons la structure:

http://farm9.staticflickr.com/8100/8651881912_e6857dcf86_b_d.jpg

Note: dans l'image ci-dessus, la tuile du champ colonee est "Landgrabbed". Comme noté plus haut, l'éditeur de structure réduit le nom. Faites passer votre souris sur le nom pour le montrer en entier.

2. L'effet est le même qu'avec l'exemple précédent de la tâche rapide. Les données du champ ligne sont résumées et groupées pour montrer une liste de pays, sans doublon. Les données du champ de données ont été ajoutées pour donner le total de chaque pays. Voici quelques exemples de ce que le tableau va produire:

http://farm9.staticflickr.com/8111/8651881924_f5f2fe488a_o_d.png

Comme précédemment, nous pouvons continuer à poser des questions sur les données en ajoutant différents champs de lignes. Les données ci-dessus montrent la quantité de terrain acquise dans chaque pays. Ajoutez "Status of deal" en tant que champ ligne pour raffiner le résulter et montrer quelles transactions sont terminées, en cours, proposées et ainsi de suite.

1. À nouveau, voici la structure du tableau:

http://farm9.staticflickr.com/8537/8651882012_9688445f9f_b_d.jpg

2. Après avoir créé le tableau à partir de la structure précédente, voici quelques-unes des lignes qu'il générera pour vous:

http://farm9.staticflickr.com/8520/8651881972_0094e4665e_o_d.png

En utilisant vos connaissances sur le choix de champs de ligne et l'ajout de champs de données, essayer de créer des tableaux croisés montrant ce qui suit:

1. un petit profil pour chaque investisseur, montrant les pays où ils ont acheté un terrain et la superficie totale de ce qu'ils ont acquis. Par exemple, un tableau montrant qu'Adecoagro a fait des transactions en Argentine pour 242000 ha, au Brésil pour 165000 ha et en Uruguay pour 8600 ha.
2. La totalité de ce que chaque investisseur a investi pour acquérir des terres. Par exemple, un tableau montrant que Saxonian Estates a investi 7,7 millions de dollars (USD) au total.
3. La quantité de terrain acquis, organisé par secteur d'investissement. Par exemple, le tableau doit montrer que 160000 ha ont été acquis par des investisseurs travaillant dans le secteur des télécommunications.
4. La quantité d'investissements faits, organisé suivant la taille des terrains acquis, montrant les pays où les terres ont été achetées. Par exemple, le tableau croisé devrait montrer que les transactions de terrains de 6000 ha ont été faites en Australie pour 335 millions de dollars (USD), en Russie pour 34 millions de dollars et au Nigéria où les informations sur l'argent investi manquent.

Bonus: Modifiez quels aspects des données sont montrés
Les champs que vous ajoutez aux tableaux croisés ont deux fonctionnalités utiles que vous devriez connaître. Nous allons les détailler par la suite, mais en voici un aperçu:

1. Les données que nous avons placées dans le champ de données du tableau sont souvent juste aditionnées − c'est-à-dire que le total est montré quand il y a plusieurs valeurs. Cependant, le tableau croisé pour montrer ces données différemment en:

- choisissant la valeur la plus élevée ou la plus basse dans une liste;
- comptant le nombre d'occurrences de valeurs données;
- calculant les données en pourcentage;
Cette fonctionnalité est activée en double-cliquant sur n'importe quelle tuile dans l'éditeur de structure du tableau.

2. Comme pour le champ de ligne, vous pouvez avoir plus d'un champ de données dans un tableau croisé. Cela signifie que vous pouvez représenter côte à côte différents aspects d'une même donnée. Pour l'utiliser, glissez un autre champ de données dans la zone de champs de données.

Voici un exemple de tableau croisé montrant ces deux fonctionnalités.

1. Ceci est la structure que vous souhaitez obtenir:

http://farm9.staticflickr.com/8519/8650783759_25799b909b_b_d.jpg

2. Pour y parvenir, construisez votre tableau comme d'habitude. Cette fois, glissez quatre fois de suite "Hectares" dans le champ de données. Vous verrez ceci:

http://farm9.staticflickr.com/8120/8650783763_950020dd67_o_d.png

3. Puis, changez la façon dont les données sont représentées. Pour cela, double-cliquez sur une des tuiles. Une fenêtre apparaîtra, comme ci-dessous:

http://farm9.staticflickr.com/8105/8651882022_4def49f6ca_o_d.png

4. Choisissez une option dans la liste puis OK.

5. Quand vous avez fait les quatre, les tuiles de la zone de champs de données de la structure ressembleront à ceci:

http://farm9.staticflickr.com/8105/8650783783_b21f9dea9b_o_d.png

6. Quand la structure est terminée, créez le tableau croisé.

7. Ce tableau croisé dynamique montrera quatre morceaux de données pour chaque pays où du terrain a été acheté: le nombre de transactions où la surface de terrain est enregistrée, la plus grande acquisition, la plus petite et la surface totale de terrain. Voici un extrait du tableau qui montre l'entrée concernant l'Argentine:

http://farm9.staticflickr.com/8536/8650783799_e5f073b57f_o_d.png

Section 3: Ajouter des colonnes aux tableaux croisés dynamiques
Dans les sections précédentes, nous avons vu comment ajouter des champs lignes et des champs de données à vos tableaux. Nous avons également vu comment trier et filtrer les données et comment adapter la représentation des données pour trouver la plus grande et la plus petite valeurs dans une liste. Dans cette section, nous allons ajouter le dernier composant de base: les champs de colonnes.

Une tâche rapide
Après presque 30 tableaux croisés dynamiques créés dans ce cours, nous sommes sûrs que y êtes maintenant habitué(e). L'étape suivante est de choisir les données pouvant être un champ colonne dans votre tableau.

1. Commencer par prendre le tableau que vous avez créé sur les friandises à la section 2. Éditez la structure. Cette fois, glissez la tuile appelée « risque pour la santé » dans la zone des champs de colonne. Cela ressemblera à ça:

http://farm9.staticflickr.com/8240/8650783997_2349e16a88_b_d.jpg

2. Après avoir créé le tableau croisé dynamique, les données avec la nouvelle colonne ressembleront à ceci:

http://farm9.staticflickr.com/8258/8651882116_19373fb432_o_d.png

L'ajout de champ colonne a pour effet de faire des sous-groupes avec les données. Voici le tableau original de la section 2, à titre de comparaison:

http://farm9.staticflickr.com/8249/8650783891_95e27f9b02_o_d.png

La version incluant les colonnes vous permet de voir d'un coup d'œil quels risques les snacks présentent, de quoi ils sont composés et combien il y en a. Mieux vaut éviter les biscuits au chocolat et le gâteau à la crème!

Une tâche plus longue
En revenant au jeu de données GRAIN, nous pouvons voir comment l'ajout de cette dernière dimension peut affecter les données montrées.

1. Créez un tableau basique montrant combien de terrain (en Hectares) a été acquis dans chaque pays ('Landgrabbed').

2. Ajoutez cette fois le champ 'Status of deal' à la zone des champs de colonne de l'éditeur de structure du tableau:

http://farm9.staticflickr.com/8249/8650783917_025a6c59e8_b_d.jpg

Le résultat ne devrait plus vous surprendre. Le tableau croisé dynamique va vous donner un aperçu des quantités totales de terrain acquises pour chaque pays, séparés en fonction du statut de la transaction:

http://farm9.staticflickr.com/8241/8651882184_aa92a7a4ce_b_d.jpg

Le champ 'Status of deal' est un champ très pratique à ajouter à la zone des champs de colonne. Lorsqu'il est résumé par le tableau, il n'a que cinq catégories distinctes. Cela signifie qu'il tient facilement dans un écran! Un champ tel que 'Production', qui a plus de 100 catégories, ne serait pas aussi simple à voir.

Essayez de changer la structure du tableau tout en conservant 'Status of deal' en colonne:

1. Remplacez la tuile des champs de ligne par 'Landgrabber' (l'investisseur) et changez la tuile des champs de données par 'Projected Investment' (la somme payée pour le terrain). Cela montre combien les investisseurs ont mis dans les transactions passées, celles qui sont signées, proposées, et ainsi de suite.
2. Remplacez les champs de ligne par 'Sector' et les champs de données par un décompte du nombre d'investisseurs. Nous avons vu comment faire cela dans le bonus de la section 2. Le tableau croisé dynamique va montrer le nombre et le statut des transactions par le secteur avec lequel l'investisseur est le plus associé.

Bonus: filtres standard
Comme nous l'avons remarqué dans la section 1, les fonctionnalités de tri et filtre du tableur fonctionnent dans les tableaux croisés dynamiques. Une autre fonctionnalité utile qui fonctionne également est le filtre standard. Nous pouvons l'utiliser pour mieux contrôler quelles données sont représentées dans une feuille de calcul et dans les tableaux croisés dynamiques. Voyons comment cela fonctionne.

1. Créez le tableau à partir des données GRAIN avec 'Landgrabbed' et 'Landgrabber' en champs de ligne, 'Status of deal' en champ de colonne et la somme de la taille totale des transactions ('Hectares') en champ de données:

http://farm9.staticflickr.com/8531/8650783981_1a48a58842_b_d.jpg

2. Cliquez sur OK. Les données produites ressembleronts à ceci:

http://farm9.staticflickr.com/8246/8650784015_fd8e793109_b_d.jpg

3. Dans le tableau résultant, cliquez sur la tuile appelée 'Filtre' dans la cellule A1. La fenêtre de critère de filtre va apparaître.

4. Modifiez les champs pour les faire ressembler à ci-dessous. Cliquez ensuite sur OK pour appliquer ce filtre sur le tableau croisé:

http://farm9.staticflickr.com/8117/8651882252_5eebe5a07a_b_d.jpg

5. Cela va filtrer les données pour ne montrer que les transactions sur 100 000 ha ou plus (>= en notation mathématique).

6. Le filtre peut être supprimé en ouvrant la fenêtre de critère de filtre et en sélectionnant 'aucun' dans le menu déroulant de nom du champ.

Section 4: Ajouter des graphiques aux tableaux croisés dynamiques
Vous pouvez faire des graphiques à partir des données produites dans un tableau croisé dynamique. Disposer d'un résumé des données et d'un graphique est un moyen d'explorer davantage et de mieux comprendre vos données. Voici un exemple simple à partir des données GRAIN.

Une fois de plus, créez un tableau de base montrer la quantité de terrain acquis dans chaque pays: glissez 'Landgrabbed' dans les champs de ligne et 'Hectares' dans les champs de données. Voici comment les données apparaîtront:

http://farm9.staticflickr.com/8525/8650784073_49f0d4076d_o_d.png

Tout d'abord, triez les données pour que la plus grande acquisition soit en haut de la liste:

1. Sélectionnez les cellules B4 à A69 (dans cet ordre).
2. Cliquez sur le bouton 'Tri décroissant' dans la barre d'outil du tableur (c'est une petite flèche vers le haut)
Ajoutez ensuite un graphique:

1. Les données devraient toujours être sélectionnées depuis que vous les avez filtrées.

2. Dans le menu du haut, allez dans Insertion → Graphique 

3. La fenêtre de l'assistant de création de graphique va apparaître. Le graphique choisi sera un histogramme vertical. Ne changez rien et choisissez juste 'Terminer' pour obtenir ce graphique dense:

http://farm9.staticflickr.com/8099/8650784079_73eab1974a_o_d.png

Puis, rafinez le graphique pour ne montrer que les dix pays où le plus de terrain a été acquis:

1. En masquant les lignes du tableau, nous pouvons changer les données montrées dans la tableau.

2. Choisissez les lignes 14 à 70. Dans le menu du haut, allez dans Format → Ligne → Masquer. Le tableau changera comme ci-dessous, ce qui est bien plus simple à comprendre:

http://farm9.staticflickr.com/8380/8650784069_9383c79099_o_d.png

Tâche rapide
Essayez de créer un tableau croisé dynamique montrant quels investisseurs ont acquis le plus de terrain.

- Plus d'informations à: http://schoolofdata.org/handbook/courses/gentle-introduction-exploring-and-understanding-data/#sthash.Zj2anwnM.dpuf
